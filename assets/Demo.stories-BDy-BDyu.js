import{__toESM as e}from"./chunk-D3B-zxXs.js";import{require_react as t}from"./react-NX0r4bef.js";import{Button as n,ChakraProvider as r,Modal as i,ShareButtons as a,action as o,jsx as s,jsxs as c,stateSwitcher as l,theme as u}from"./ShareButtons-Bw3UpBGY.js";var d,f;function p(e){return new Promise(t=>{setTimeout(t,e)})}async function m(e,t,n){return await p(3e3),e(`ringing`),await p(3e3),Math.random()>.5?(e(`failed`),!1):(e(`in-progress`),await p(3e3),e(`completed`),!0)}var h=e(t());function g(){}function _({children:e=void 0,script:t,targets:n,theme:r=u,userPhoneNumber:a,onFail:o=g,onFinish:c=g,onSuccess:d=g}){let[f,p]=(0,h.useState)(`idle`),[_,v]=(0,h.useState)(!1),[y,b]=(0,h.useState)(0);(0,h.useEffect)(()=>{f===`completed`&&d()},[d,f]);let x=(0,h.useCallback)(()=>{v(!0),o(f)},[o,v,f]),S=(0,h.useCallback)(()=>{f!==`completed`&&!_&&o(f),c(f),p(`idle`)},[o,c,p,f,_]),C=(0,h.useMemo)(()=>{if(n.length<=1)return n;let e=[...n];for(let t=e.length-1;t>0;t--){let n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},[n]),w=(0,h.useMemo)(()=>C[y%C.length],[C,y]),T=(0,h.useMemo)(()=>{let e=Math.ceil(n.length*1.5);return y<e},[y,n]),E=(0,h.useCallback)(()=>{p(`idle`),b(e=>e+1)},[b,p]);(0,h.useEffect)(()=>{async function e(){await m(p,a,w.phoneNumber)}e()},[p,w,a]);let D=l(f,_);if(D){let n={canRetry:T,postActions:e,script:t,target:w,theme:r,userPhoneNumber:a,onDismiss:S,onRetry:E,onShare:x};return s(i,{theme:r,onDismiss:S,...D(n)})}else return null}try{_.displayName=`PhoneCall`,_.__docgenInfo={description:``,displayName:`PhoneCall`,props:{script:{defaultValue:null,description:``,name:`script`,required:!0,type:{name:`string`}},targets:{defaultValue:null,description:``,name:`targets`,required:!0,type:{name:`PhoneTarget[]`}},theme:{defaultValue:null,description:``,name:`theme`,required:!0,type:{name:`{ brand: { main: string; dark: string; light: string; }; commons: { dark: string; main: string; light: string; }; fontFamily: string; body: { padding: number; background: { light: string; main: string; dark: string; }; }; ... 4 more ...; error: string; }`}},userPhoneNumber:{defaultValue:null,description:``,name:`userPhoneNumber`,required:!0,type:{name:`string`}},onFail:{defaultValue:null,description:``,name:`onFail`,required:!1,type:{name:`((state: PhoneCallState) => void)`}},onFinish:{defaultValue:null,description:``,name:`onFinish`,required:!1,type:{name:`((state: PhoneCallState) => void)`}},onSuccess:{defaultValue:null,description:``,name:`onSuccess`,required:!1,type:{name:`(() => void)`}}}}}catch{}function v(e,t){return(...n)=>{t(!1),e(...n)}}const y=function(e,{args:t}){let[i,a]=(0,h.useState)(!1),o=()=>a(!0),l=v(t.onFinish,a);return c(r,{children:[s(n,{type:`button`,variant:`solid`,onClick:o,children:`Ligar`}),i&&s(e,{args:{...t,onFinish:l}})]})},b={title:`Phone Call`,component:_,decorators:y,argTypes:{children:{description:`Conteúdo exibido ao compartilhar a campanha`,defaultValue:void 0,table:{type:`JSX.Element`}},script:{description:`Roteiro da ligação`,type:`string`},targets:{description:`Lista de alvos`},theme:{description:`Tema da campanha`},userPhoneNumber:{description:`Número de telefone do usuário`,type:`string`},onFail:{description:`Evento disparado quando a ligação falhou (número de tentativas excedido, usuário desistiu, etc.)`,type:`function`},onFinish:{description:`Evento disparado quando a interação do usuário foi encerrada (o modal de ligação foi fechado)`,type:`function`},onSuccess:{description:`Evento disparado quando a ligação foi finalizada com sucesso`,type:`function`}},parameters:{controls:{exclude:[`children`,`onFail`,`onFinish`,`onSuccess`]}}};var x=b;const S={args:{children:s(a,{theme:u}),script:`Olá, meu nome é [seu nome]. Estou ligando para pedir que [nome do alvo] faça [ação solicitada]. Essa decisão é muito importante porque [insira argumento principal]. Contamos com o apoio de vocês!`,userPhoneNumber:`+55 11 00000-0000`,targets:[{label:`Dep. Fulano`,phoneNumber:`+55 22 00000-0000`},{label:`Sen. Sicrana`,phoneNumber:`+55 33 00000-0000`}],theme:u,onFail:o(`onFail`),onFinish:o(`onFinish`),onSuccess:o(`onSuccess`)}};S.parameters={...S.parameters,docs:{...(d=S.parameters)?.docs,source:{originalSource:`{
  args: {
    children: <ShareButtons theme={Theme} />,
    script: 'Olá, meu nome é [seu nome]. Estou ligando para pedir que [nome do alvo] faça [ação solicitada]. Essa decisão é muito importante porque [insira argumento principal]. Contamos com o apoio de vocês!',
    userPhoneNumber: '+55 11 00000-0000',
    targets: [{
      label: 'Dep. Fulano',
      phoneNumber: '+55 22 00000-0000'
    }, {
      label: 'Sen. Sicrana',
      phoneNumber: '+55 33 00000-0000'
    }],
    theme: Theme,
    onFail: action('onFail'),
    onFinish: action('onFinish'),
    onSuccess: action('onSuccess')
  }
}`,...(f=S.parameters)==null||(f=f.docs)==null?void 0:f.source}}};const C=[`Demo`];export{S as Demo,x as Demo_stories_default,C as __namedExportsOrder};