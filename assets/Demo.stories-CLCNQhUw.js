import{__export as e,__toESM as t}from"./chunk-D3B-zxXs.js";import{require_react as n}from"./react-NX0r4bef.js";import{Button as r,ChakraProvider as i,Modal as a,ShareButtons as o,action as s,jsx as c,jsxs as l,stateSwitcher as u,theme as d}from"./ShareButtons-Bw3UpBGY.js";var f,p;function m(e){return new Promise(t=>{setTimeout(t,e)})}async function h(e,t,n){return await m(3e3),e(`ringing`),await m(3e3),Math.random()>.5?(e(`failed`),!1):(e(`in-progress`),await m(3e3),e(`completed`),!0)}var g=t(n());function _(){}function v({children:e=void 0,script:t,targets:n,theme:r=d,userPhoneNumber:i,onFail:o=_,onFinish:s=_,onSuccess:l=_}){let[f,p]=(0,g.useState)(`idle`),[m,v]=(0,g.useState)(!1),[y,b]=(0,g.useState)(0);(0,g.useEffect)(()=>{f===`completed`&&l()},[l,f]);let x=(0,g.useCallback)(()=>{v(!0),o(f)},[o,v,f]),S=(0,g.useCallback)(()=>{f!==`completed`&&!m&&o(f),s(f),p(`idle`)},[o,s,p,f,m]),C=(0,g.useMemo)(()=>{if(n.length<=1)return n;let e=[...n];for(let t=e.length-1;t>0;t--){let n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},[n]),w=(0,g.useMemo)(()=>C[y%C.length],[C,y]),T=(0,g.useMemo)(()=>{let e=Math.ceil(n.length*1.5);return y<e},[y,n]),E=(0,g.useCallback)(()=>{p(`idle`),b(e=>e+1)},[b,p]);(0,g.useEffect)(()=>{async function e(){await h(p,i,w.phoneNumber)}e()},[p,w,i]);let D=u(f,m);if(D){let n={canRetry:T,postActions:e,script:t,target:w,theme:r,userPhoneNumber:i,onDismiss:S,onRetry:E,onShare:x};return c(a,{theme:r,onDismiss:S,...D(n)})}else return null}try{v.displayName=`PhoneCall`,v.__docgenInfo={description:``,displayName:`PhoneCall`,props:{script:{defaultValue:null,description:``,name:`script`,required:!0,type:{name:`string`}},targets:{defaultValue:null,description:``,name:`targets`,required:!0,type:{name:`PhoneTarget[]`}},theme:{defaultValue:null,description:``,name:`theme`,required:!0,type:{name:`{ brand: { main: string; dark: string; light: string; }; commons: { dark: string; main: string; light: string; }; fontFamily: string; body: { padding: number; background: { light: string; main: string; dark: string; }; }; ... 4 more ...; error: string; }`}},userPhoneNumber:{defaultValue:null,description:``,name:`userPhoneNumber`,required:!0,type:{name:`string`}},onFail:{defaultValue:null,description:``,name:`onFail`,required:!1,type:{name:`((state: PhoneCallState) => void)`}},onFinish:{defaultValue:null,description:``,name:`onFinish`,required:!1,type:{name:`((state: PhoneCallState) => void)`}},onSuccess:{defaultValue:null,description:``,name:`onSuccess`,required:!1,type:{name:`(() => void)`}}}}}catch{}var y={};e(y,{Demo:()=>w,__namedExportsOrder:()=>T,default:()=>C});function b(e,t){return(...n)=>{t(!1),e(...n)}}const x=function(e,{args:t}){let[n,a]=(0,g.useState)(!1),o=()=>a(!0),s=b(t.onFinish,a);return l(i,{children:[c(r,{type:`button`,variant:`solid`,onClick:o,children:`Ligar`}),n&&c(e,{args:{...t,onFinish:s}})]})},S={title:`Phone Call`,component:v,decorators:x,argTypes:{children:{description:`Conteúdo exibido ao compartilhar a campanha`,defaultValue:void 0,table:{type:`JSX.Element`}},script:{description:`Roteiro da ligação`,type:`string`},targets:{description:`Lista de alvos`},theme:{description:`Tema da campanha`},userPhoneNumber:{description:`Número de telefone do usuário`,type:`string`},onFail:{description:`Evento disparado quando a ligação falhou (número de tentativas excedido, usuário desistiu, etc.)`,type:`function`},onFinish:{description:`Evento disparado quando a interação do usuário foi encerrada (o modal de ligação foi fechado)`,type:`function`},onSuccess:{description:`Evento disparado quando a ligação foi finalizada com sucesso`,type:`function`}},parameters:{controls:{exclude:[`children`,`onFail`,`onFinish`,`onSuccess`]}}};var C=S;const w={args:{children:c(o,{theme:d}),script:`Olá, meu nome é [seu nome]. Estou ligando para pedir que [nome do alvo] faça [ação solicitada]. Essa decisão é muito importante porque [insira argumento principal]. Contamos com o apoio de vocês!`,userPhoneNumber:`+55 11 00000-0000`,targets:[{label:`Dep. Fulano`,phoneNumber:`+55 22 00000-0000`},{label:`Sen. Sicrana`,phoneNumber:`+55 33 00000-0000`}],theme:d,onFail:s(`onFail`),onFinish:s(`onFinish`),onSuccess:s(`onSuccess`)}};w.parameters={...w.parameters,docs:{...(f=w.parameters)?.docs,source:{originalSource:`{
  args: {
    children: <ShareButtons theme={Theme} />,
    script: 'Olá, meu nome é [seu nome]. Estou ligando para pedir que [nome do alvo] faça [ação solicitada]. Essa decisão é muito importante porque [insira argumento principal]. Contamos com o apoio de vocês!',
    userPhoneNumber: '+55 11 00000-0000',
    targets: [{
      label: 'Dep. Fulano',
      phoneNumber: '+55 22 00000-0000'
    }, {
      label: 'Sen. Sicrana',
      phoneNumber: '+55 33 00000-0000'
    }],
    theme: Theme,
    onFail: action('onFail'),
    onFinish: action('onFinish'),
    onSuccess: action('onSuccess')
  }
}`,...(p=w.parameters)==null||(p=p.docs)==null?void 0:p.source}}};const T=[`Demo`];export{w as Demo,C as Demo_stories_default,y as Demo_stories_exports,T as __namedExportsOrder};